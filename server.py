import socket

def start_server():
    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server_address = ('localhost', 12345)
    server_socket.bind(server_address)

    server_socket.listen(1)
    print("Le serveur écoute sur le port 12345")

    while True:
        print("En attente de connexion client...")
        connection, client_address = server_socket.accept()
        try:
            print(f"Connecté à {client_address}")
            while True:
                command = input("Entrer la commande : 'c', 'd' ou 'q pour quit': ")
                if command == 'q':
                    connection.send(command.encode())
                    ack = connection.recv(1024).decode()
                    print(f"Réponse du client : {ack}")
                    break
                if command == 'c' or command == 'd':
                    connection.send(command.encode())
                    ack = connection.recv(1024).decode()
                    print(f"Réponse du client : {ack}")
        finally:
            connection.close()
            print("Connexion fermée.")
            break 
    server_socket.close()
    print("Serveur arrêté.")

start_server()
