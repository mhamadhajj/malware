import socket

def start_server():
    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server_address = ('localhost', 12345)
    server_socket.bind(server_address)

    server_socket.listen(1)
    print("Le serveur écoute sur le port 12345")

    while True:
        print("En attente de connexion client...")
        connection, client_address = server_socket.accept()

        try:
            print(f"Connecté à {client_address}")
            command = 'chiffre' 
            print(f"Envoi de la commande '{command}' au client.")
            connection.send(command.encode())
            ack = connection.recv(1024).decode()
            command = 'dechiffre' 
            print(f"Envoi de la commande '{command}' au client.")
            connection.send(command.encode())
        finally:
            connection.close()
            break 

    server_socket.close()

start_server()
